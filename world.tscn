[gd_scene load_steps=31 format=4 uid="uid://cixa04axuf1co"]

[ext_resource type="Script" uid="uid://pktt3oehs78d" path="res://MenuCanvas.gd" id="3_nmfmg"]
[ext_resource type="PackedScene" uid="uid://cymxvi3bjj71b" path="res://enemy.tscn" id="4_xr0ro"]
[ext_resource type="PackedScene" uid="uid://kadcr801fqcm" path="res://player/Player.tscn" id="5_taioi"]
[ext_resource type="Script" uid="uid://c1ys4g3gyj1mj" path="res://inventory/menu/PrimaryWeaponStack.cs" id="5_vq0ba"]
[ext_resource type="Script" uid="uid://br7vpr5hwlegd" path="res://inventory/menu/InventoryStack.cs" id="6_6wwjs"]
[ext_resource type="Script" uid="uid://2umc6lehruyd" path="res://GameUI.cs" id="7_gbfbk"]
[ext_resource type="FontFile" uid="uid://cpuwdglpinmhy" path="res://shared/fonts/Pixel.ttf" id="8_ic0uy"]
[ext_resource type="Script" uid="uid://ckhbaxtaa30xu" path="res://Crosshair.cs" id="8_ioo17"]
[ext_resource type="PackedScene" uid="uid://d07f71yhlond8" path="res://environment/grass/grass_multi.tscn" id="11_k3n1d"]
[ext_resource type="Script" uid="uid://bhxrowu6uq8vq" path="res://bullets/manager/BulletManager.cs" id="12_bmngr"]
[ext_resource type="Texture2D" uid="uid://d038lo6vi57t5" path="res://models/linen_with_flowers_2.png" id="13_2o6r5"]
[ext_resource type="Texture2D" uid="uid://dl2exy6bsks5w" path="res://assets/ui/3x/ninepatch.png" id="14_nptex"]
[ext_resource type="Script" uid="uid://cogtw56d6pcwk" path="res://inventory/menu/PrimaryWeaponInfo.cs" id="16_wpnfo"]
[ext_resource type="Script" uid="uid://cugk52p23i4y" path="res://spawning/EnemySpawner.cs" id="17_spwnr"]
[ext_resource type="Script" uid="uid://cddsl5dv5vqa7" path="res://shop/ShopStand.cs" id="18_shop"]
[ext_resource type="Script" path="res://environment/generation/ProceduralMapGenerator.cs" id="19_mapgen"]
[ext_resource type="MapChunkSet" path="res://environment/generation/island_chunk_set.tres" id="20_chunkset"]

[sub_resource type="GDScript" id="GDScript_ic0uy"]
script/source = "extends Node

@onready var main_menu = get_node_or_null(\"CanvasLayer/MainMenu\")
@onready var address_entry = get_node_or_null(\"CanvasLayer/MainMenu/MarginContainer/VBoxContainer/AddressEntry\")
@onready var hud = get_node_or_null(\"CanvasLayer/HUD\")
@onready var health_bar = get_node_or_null(\"CanvasLayer/HUD/HealthBar\")

func _unhandled_input(_event):
	if Input.is_action_just_pressed(\"quit\"):
		if GlobalEvents:
			var pause_menu = GlobalEvents.get_node_or_null(\"PauseMenu\")
			if pause_menu:
				var toggle = Callable(pause_menu, \"ToggleFromWorld\")
				if toggle.is_valid():
					toggle.call()
					get_viewport().set_input_as_handled()
					return
		get_tree().quit()

func _on_host_button_pressed():
	if main_menu:
		main_menu.hide()
	if hud:
		hud.show()

func update_health_bar(health_value):
	if health_bar:
		health_bar.value = health_value
"

[sub_resource type="PhysicalSkyMaterial" id="PhysicalSkyMaterial_k3n1d"]
rayleigh_color = Color(0.180857, 0.256698, 0.398178, 1)
mie_color = Color(0.452317, 0.503161, 0.613038, 1)
turbidity = 0.0
ground_color = Color(1, 1, 1, 1)

[sub_resource type="Sky" id="Sky_w2qqb"]
sky_material = SubResource("PhysicalSkyMaterial_k3n1d")
process_mode = 1

[sub_resource type="Environment" id="Environment_6knbf"]
background_mode = 2
background_intensity = 1.0
sky = SubResource("Sky_w2qqb")
ambient_light_color = Color(1, 1, 1, 1)
ambient_light_energy = 1.2
ambient_light_sky_contribution = 0.0
tonemap_mode = 0
ssr_enabled = false
ssao_enabled = false
ssil_enabled = false
sdfgi_enabled = false
glow_enabled = false
fog_enabled = false

[sub_resource type="FastNoiseLite" id="FastNoiseLite_k3n1d"]
noise_type = 0
frequency = 0.0191
fractal_weighted_strength = 1.0
metadata/_preview_in_3d_space_ = true

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_2o6r5"]
noise = SubResource("FastNoiseLite_k3n1d")
seamless = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_s22qn"]
resource_name = "Material_36"
transparency = 4
cull_mode = 2
albedo_texture = ExtResource("13_2o6r5")
roughness = 0.892971
emission_enabled = false
emission = Color(0, 0, 0, 1)
emission_intensity = 0.0

[sub_resource type="ArrayMesh" id="ArrayMesh_impft"]
_surfaces = [{
"aabb": AABB(-112.4, 34.047, -149.316, 180.296, 74.3073, 169.745),
"format": 34896613377,
"index_count": 36,
"index_data": PackedByteArray("AAABAAIAAAADAAEABAAFAAYABAAHAAUACAAJAAoACAALAAkADAANAA4ADAAPAA0AEAARABIAEAATABEAFAAVABYAFAAXABUA"),
"name": "Material_36",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 24,
"vertex_data": PackedByteArray("KMztd///AABk0yRvP8EAAB7sL2TA5QAAb7Pign7bAABYyjscu6UAAH/x2hKVgwAAH+MAAGKgAAC42BYv7ogAADRJ1HB5rQAAdTjrcelvAAD+V9SHB4kAAKwp61pblAAAAADwX1wwAABsOAhhmRAAAMsn8XboNAAAoBAHSgwMAAAzUIDosx0AAFp+Zem4AwAAwHBR+2shAADNXZTWAAAAANjYJO2TJwAA///D420FAACf8ejQOiIAADjn///GCgAA")
}]
blend_shape_mode = 0

[sub_resource type="ArrayMesh" id="ArrayMesh_u887k"]
resource_name = "Sketchfab_Scene_Linen_wFlower_L_Material #36_0"
_surfaces = [{
"aabb": AABB(-112.4, 34.047, -149.316, 180.296, 74.3073, 169.745),
"attribute_data": PackedByteArray("AAAAAP///////wAAAAD//wAAAAD///////8AAAAA//8AAAAA////////AAAAAP//AAAAAP///////wAAAAD//wAAAAD///////8AAAAA//8AAAAA////////AAAAAP//"),
"format": 34896613399,
"index_count": 36,
"index_data": PackedByteArray("AAABAAIAAAADAAEABAAFAAYABAAHAAUACAAJAAoACAALAAkADAANAA4ADAAPAA0AEAARABIAEAATABEAFAAVABYAFAAXABUA"),
"material": SubResource("StandardMaterial3D_s22qn"),
"name": "Material_36",
"primitive": 3,
"uv_scale": Vector4(0, 0, 0, 0),
"vertex_count": 24,
"vertex_data": PackedByteArray("KMztd///+Txk0yRvP8H5PB7sL2TA5fk8b7Pign7b+TxYyjscu6WmUX/x2hKVg6ZRH+MAAGKgplG42BYv7oimUTRJ1HB5rb8vdTjrcelvvy/+V9SHB4m/L6wp61pblL8vAADwX1wwEzJsOAhhmRATMssn8XboNBMyoBAHSgwMEzIzUIDosx0TMlp+Zem4AxMywHBR+2shEzLNXZTWAAATMtjYJO2TJ6ZR///D420FplGf8ejQOiKmUTjn///GCqZRxtzyS8bc8kvG3PJLxtzyS17MaGJezGhiXsxoYl7MaGL86EY6/OhGOvzoRjr86EY6Re8MlEXvDJRF7wyURe8MlEXvDJRF7wyURe8MlEXvDJRezGhiXsxoYl7MaGJezGhi")
}]
blend_shape_mode = 0
shadow_mesh = SubResource("ArrayMesh_impft")

[sub_resource type="FastNoiseLite" id="FastNoiseLite_2o6r5"]
noise_type = 2
frequency = 0.086
offset = Vector3(0, -20.6, 0)
fractal_weighted_strength = 1.0

[sub_resource type="NoiseTexture3D" id="NoiseTexture3D_70uel"]
noise = SubResource("FastNoiseLite_2o6r5")

[sub_resource type="FogMaterial" id="FogMaterial_2o6r5"]
density_texture = SubResource("NoiseTexture3D_70uel")

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_inv"]
content_margin_left = 16.0
content_margin_top = 16.0
content_margin_right = 16.0
content_margin_bottom = 16.0
texture = ExtResource("14_nptex")
texture_margin_left = 18.0
texture_margin_top = 18.0
texture_margin_right = 18.0
texture_margin_bottom = 18.0
axis_stretch_horizontal = 1
axis_stretch_vertical = 1

[node name="World2" type="Node"]
script = SubResource("GDScript_ic0uy")

[node name="BulletManager" type="Node3D" parent="."]
script = ExtResource("12_bmngr")

[node name="Player" parent="." instance=ExtResource("5_taioi")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.12916, 3.88055, -7.5407)

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
visible = false
transform = Transform3D(-0.866025, -0.433013, 0.25, 0.032571, 0.450081, 0.892394, -0.498938, 0.780978, -0.375678, 133.654, 359.376, -145.03)
light_intensity_lux = 0.0
light_energy = 0.0
sky_mode = 0

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_6knbf")

[node name="MenuCanvas" type="CanvasLayer" parent="."]
layer = 2
script = ExtResource("3_nmfmg")

[node name="EnemySpawner" type="Node3D" parent="."]
script = ExtResource("17_spwnr")
EnemyScene = ExtResource("4_xr0ro")

[node name="ShopStand" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.5, 3.3, -2.5)
script = ExtResource("18_shop")

[node name="ProceduralMap" type="Node3D" parent="."]
script = ExtResource("19_mapgen")
UseRandomSeed = false
Seed = 1
ChunkTag = "default"
ChunkSet = ExtResource("20_chunkset")

[node name="GrassMulti" parent="." instance=ExtResource("11_k3n1d")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0569916, -0.0810356, -0.11758)
layers = 34815
cast_shadow = 0
gi_lightmap_texel_scale = 0.01
Width = 100.0
Depth = 100.0
InstanceCount = 80000
NoiseTexture = SubResource("NoiseTexture2D_2o6r5")

[node name="FlowerMulti" parent="." instance=ExtResource("11_k3n1d")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0569916, -0.0810356, -0.11758)
layers = 34815
cast_shadow = 0
gi_lightmap_texel_scale = 0.01
GrassMesh = SubResource("ArrayMesh_u887k")
Width = 100.0
Depth = 100.0
InstanceCount = 40
NoiseTexture = SubResource("NoiseTexture2D_2o6r5")
MeshScale = 0.004
SpawnPointLights = false
LightEnergy = 0.0
LightRange = 0.0

[node name="GameUI" type="CanvasLayer" parent="."]
script = ExtResource("7_gbfbk")

[node name="FogVolume" type="FogVolume" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 19.4103, -19.1621, 0)
visible = false
size = Vector3(200, 20, 200)
material = SubResource("FogMaterial_2o6r5")

[node name="MenuCanvas#MenuRoot" type="MarginContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
theme_override_constants/margin_left = 32
theme_override_constants/margin_top = 32
theme_override_constants/margin_right = 32
theme_override_constants/margin_bottom = 32

[node name="MenuCanvas_MenuRoot#VBox" type="VBoxContainer" parent="."]
size_flags_horizontal = 3
size_flags_vertical = 3

[node name="MenuCanvas_MenuRoot_VBox#PrimaryWeaponInfo" type="PanelContainer" parent="."]
texture_filter = 1
size_flags_horizontal = 3
theme_override_styles/panel = SubResource("StyleBoxTexture_inv")
script = ExtResource("16_wpnfo")

[node name="MenuCanvas_MenuRoot_VBox#WeaponInventoryDisplay" type="Panel" parent="."]
texture_filter = 1
size_flags_horizontal = 3
theme_override_styles/panel = SubResource("StyleBoxTexture_inv")
script = ExtResource("5_vq0ba")
PlaceholderWidth = 8.0

[node name="MenuCanvas_MenuRoot_VBox#InventoryStack" type="Panel" parent="."]
texture_filter = 1
size_flags_horizontal = 3
theme_override_styles/panel = SubResource("StyleBoxTexture_inv")
script = ExtResource("6_6wwjs")
PlaceholderWidth = 8.0

[node name="GameUI#UIRoot" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="GameUI_UIRoot#Center" type="CenterContainer" parent="."]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -50.0
offset_top = 51.0
offset_right = -50.0
offset_bottom = 51.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="GameUI_UIRoot_Center#Crosshair" type="Control" parent="."]
custom_minimum_size = Vector2(40, 40)
layout_mode = 3
anchors_preset = 0
mouse_filter = 2
script = ExtResource("8_ioo17")

[node name="GameUI_UIRoot#TopCenter" type="MarginContainer" parent="."]
anchors_preset = 10
anchor_right = 1.0
offset_top = 10.0
offset_bottom = 90.0
mouse_filter = 2
theme_override_constants/margin_left = 20
theme_override_constants/margin_top = 0
theme_override_constants/margin_right = 20
theme_override_constants/margin_bottom = 0

[node name="GameUI_UIRoot_TopCenter#Center" type="CenterContainer" parent="."]
mouse_filter = 2

[node name="GameUI_UIRoot_TopCenter_Center#ComboWrapper" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
mouse_filter = 2

[node name="GameUI_UIRoot_TopCenter_Center_ComboWrapper#ComboLabel" type="RichTextLabel" parent="."]
mouse_filter = 2
theme_override_fonts/normal_font = ExtResource("8_ic0uy")
theme_override_font_sizes/normal_font_size = 40
horizontal_alignment = 1
vertical_alignment = 1

[node name="GameUI_UIRoot#BottomCenter" type="MarginContainer" parent="."]
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -100.0
offset_bottom = -20.0
mouse_filter = 2
theme_override_constants/margin_left = 20
theme_override_constants/margin_top = 0
theme_override_constants/margin_right = 20
theme_override_constants/margin_bottom = 0

[node name="GameUI_UIRoot_BottomCenter#Center" type="CenterContainer" parent="."]
mouse_filter = 2

[node name="GameUI_UIRoot_BottomCenter_Center#InteractionLabel" type="RichTextLabel" parent="."]
mouse_filter = 2
theme_override_fonts/normal_font = ExtResource("8_ic0uy")

[node name="GameUI_UIRoot#BottomRight" type="MarginContainer" parent="."]
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -260.0
offset_top = -110.0
offset_right = -20.0
offset_bottom = -20.0
mouse_filter = 2

[node name="GameUI_UIRoot_BottomRight#MoneyCounter" type="RichTextLabel" parent="."]
mouse_filter = 2
theme_override_fonts/normal_font = ExtResource("8_ic0uy")
theme_override_font_sizes/normal_font_size = 40
text = "0"
horizontal_alignment = 1
vertical_alignment = 1
